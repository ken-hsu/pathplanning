<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">point_latlon</span> = L1Algorithm (<span class="var type1" id="S3T1U6">waypoint_latlon</span>,<span class="var type1" id="S4T2U7">L1_distance</span>,<span class="var type1" id="S5T3U8">uavHome_latlon</span>,<span class="var type1" id="S6T2U9">Yaw</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%% for simulation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%     clear all;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%     % parameter setting</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%     L1_distance = 110;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%     % read plan from file</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%     fileID = fopen('/home/ken/Documents/xxxx.plan');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%     C = textscan(fileID, '%s','Delimiter',',');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%     co = 0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%     for i = 1:size(C{1},1)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%     if (C{1}{i} == num2str(0))</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%     co = co +1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%     numOfWaypoint = co/3 +1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%     waypoint_latlon = zeros(2,numOfWaypoint);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%     for i = 1:numOfWaypoint-1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%     waypoint_latlon(1,i+1) = str2double(C{1}{29+(i-1)*19})*pi/180;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%     waypoint_latlon(2,i+1) = str2double(C{1}{30+(i-1)*19})*pi/180;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%     end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%     % uav condition</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%     Yaw = 0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%     uavHome_latlon = [47.397742 8.545594]'*pi/180;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%% for code generation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">    <span class="comment">% number of waypoint</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line">    <span class="mxinfo " id="T2:U6"><span class="var type1" id="S7T2U12">numOfWaypoint</span> = <span class="mxinfo " id="T2:U8">size(<span class="var type1" id="S3T1U15">waypoint_latlon</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">    <span class="comment">% Constant</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line">    <span class="mxinfo " id="T2:U10"><span class="var type1" id="S9T2U19">radiousOfEarth</span> = <span class="mxinfo " id="T2:U12">6371000</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">    <span class="comment">% first waypoint is home position</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="mxinfo " id="T3:U13"><span class="mxinfo " id="T3:U14"><span class="var type1" id="S3T1U24">waypoint_latlon</span>(<span class="mxinfo " id="T4:U16">:</span>,<span class="mxinfo " id="T2:U17">1</span>)</span> = <span class="var type1" id="S5T3U27">uavHome_latlon</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">    <span class="comment">% transfer latlon to meter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">    <span class="mxinfo " id="T1:U19"><span class="var type1" id="S10T1U30">waypoint_cartesianNE</span> = <span class="mxinfo " id="T1:U21"><span class="mxinfo " id="T1:U22">[<span class="mxinfo " id="T5:U23"><span class="mxinfo " id="T5:U24"><span class="var type1" id="S3T1U36">waypoint_latlon</span>(<span class="mxinfo " id="T6:U26">1</span>,<span class="mxinfo " id="T7:U27">:</span>)</span> - <span class="mxinfo " id="T2:U28"><span class="var type1" id="S5T3U40">uavHome_latlon</span>(<span class="mxinfo " id="T2:U30">1</span>)</span></span>;<span class="mxinfo " id="T5:U31">(<span class="mxinfo " id="T5:U32"><span class="mxinfo " id="T5:U33"><span class="var type1" id="S3T1U47">waypoint_latlon</span>(<span class="mxinfo " id="T6:U35">2</span>,<span class="mxinfo " id="T7:U36">:</span>)</span> - <span class="mxinfo " id="T2:U37"><span class="var type1" id="S5T3U51">uavHome_latlon</span>(<span class="mxinfo " id="T2:U39">2</span>)</span></span>)*<span class="mxinfo " id="T2:U40">cos(<span class="mxinfo " id="T2:U41"><span class="var type1" id="S5T3U56">uavHome_latlon</span>(<span class="mxinfo " id="T6:U43">1</span>)</span>)</span></span>]</span>*<span class="var type1" id="S9T2U58">radiousOfEarth</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">    <span class="mxinfo " id="T3:U45"><span class="var type1" id="S12T3U61">uavHome_cartesian</span> = <span class="mxinfo " id="T3:U47"><span class="mxinfo " id="T8:U48">[<span class="mxinfo " id="T2:U49">0</span> <span class="mxinfo " id="T2:U50">0</span>]</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="mxinfo " id="T3:U51"><span class="var type1" id="S13T3U69">uavLocation</span> = <span class="var type1" id="S12T3U70">uavHome_cartesian</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="comment">% calculate total distance for the parameter declaration</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">    <span class="mxinfo " id="T1:U54"><span class="var type1" id="S14T1U73">vector</span> = <span class="mxinfo " id="T1:U56"><span class="mxinfo " id="T1:U57"><span class="var type1" id="S10T1U76">waypoint_cartesianNE</span>(<span class="mxinfo " id="T4:U59">:</span>,<span class="mxinfo " id="T5:U60"><span class="mxinfo " id="T2:U61">2</span>:end</span>)</span> - <span class="mxinfo " id="T1:U62"><span class="var type1" id="S10T1U83">waypoint_cartesianNE</span>(<span class="mxinfo " id="T4:U64">:</span>,<span class="mxinfo " id="T5:U65"><span class="mxinfo " id="T2:U66">1</span>:<span class="mxinfo " id="T2:U67"><span class="mxinfo " id="T2:U68">end</span>-<span class="mxinfo " id="T2:U69">1</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line">    <span class="mxinfo " id="T2:U70"><span class="var type1" id="S16T2U93">totalDistance</span> = <span class="mxinfo " id="T2:U72">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S17T2U97">i</span> = <span class="mxinfo " id="T2:U74">1</span>:<span class="mxinfo " id="T2:U75"><span class="var type1" id="S7T2U101">numOfWaypoint</span>-<span class="mxinfo " id="T2:U77">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T2:U78"><span class="var type1" id="S16T2U105">totalDistance</span> = <span class="mxinfo " id="T2:U80"><span class="mxinfo " id="T2:U81">norm(<span class="mxinfo " id="T3:U82"><span class="var type1" id="S14T1U110">vector</span>(<span class="mxinfo " id="T4:U84">:</span>,<span class="var type1" id="S17T2U112">i</span>)</span>)</span> + <span class="var type1" id="S16T2U113">totalDistance</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">    <span class="mxinfo " id="T2:U87"><span class="var type1" id="S19T2U116">predictNumOfPoint</span> = <span class="mxinfo " id="T2:U89">floor(<span class="mxinfo " id="T2:U90"><span class="var type1" id="S16T2U120">totalDistance</span>*<span class="mxinfo " id="T2:U92">1.2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo " id="T1:U93"><span class="var type1" id="S21T1U124">point_cartesianNE</span> = <span class="mxinfo " id="T1:U95">zeros(<span class="mxinfo " id="T2:U96">2</span>,<span class="var type1" id="S19T2U128">predictNumOfPoint</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">    <span class="comment">% L1 algorithm</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo " id="T2:U98"><span class="var type1" id="S23T2U131">numOfPoint</span> = <span class="mxinfo " id="T2:U100">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S17T2U135">i</span> = <span class="mxinfo " id="T2:U102">1</span>:<span class="mxinfo " id="T2:U103"><span class="var type1" id="S7T2U139">numOfWaypoint</span>-<span class="mxinfo " id="T2:U105">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">        <span class="mxinfo " id="T3:U106"><span class="var type1" id="S24T3U143">vectorBP</span> = <span class="mxinfo " id="T3:U108"><span class="var type1" id="S13T3U145">uavLocation</span> - <span class="mxinfo " id="T3:U110"><span class="var type1" id="S10T1U147">waypoint_cartesianNE</span>(<span class="mxinfo " id="T4:U112">:</span>,<span class="mxinfo " id="T2:U113"><span class="var type1" id="S17T2U150">i</span>+<span class="mxinfo " id="T2:U115">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">        <span class="mxinfo " id="T2:U116"><span class="var type1" id="S25T2U154">BP_distance</span> = <span class="mxinfo " id="T2:U118">norm(<span class="var type1" id="S24T3U157">vectorBP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">        <span class="mxinfo " id="T3:U120"><span class="var type1" id="S26T3U160">vectorAB</span> = <span class="mxinfo " id="T3:U122"><span class="mxinfo " id="T3:U123"><span class="var type1" id="S10T1U163">waypoint_cartesianNE</span>(<span class="mxinfo " id="T4:U125">:</span>,<span class="mxinfo " id="T2:U126"><span class="var type1" id="S17T2U166">i</span>+<span class="mxinfo " id="T2:U128">1</span></span>)</span> - <span class="mxinfo " id="T3:U129"><span class="var type1" id="S10T1U169">waypoint_cartesianNE</span>(<span class="mxinfo " id="T4:U131">:</span>,<span class="var type1" id="S17T2U171">i</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">        <span class="mxinfo " id="T2:U133"><span class="var type1" id="S27T2U174">AB_distance</span> = <span class="mxinfo " id="T2:U135">norm(<span class="var type1" id="S26T3U177">vectorAB</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">        <span class="mxinfo " id="T3:U137"><span class="var type1" id="S28T3U180">vectorAB_unit</span> = <span class="mxinfo " id="T3:U139"><span class="var type1" id="S26T3U182">vectorAB</span>/<span class="var type1" id="S27T2U183">AB_distance</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">        <span class="keyword">while</span> <span class="mxinfo " id="T9:U142"><span class="var type1" id="S25T2U187">BP_distance</span> &gt;<span class="mxinfo " id="T2:U144">30</span></span> &amp;&amp; <span class="mxinfo " id="T9:U145"><span class="mxinfo " id="T2:U146"><span class="mxinfo " id="T8:U147"><span class="var type1" id="S24T3U192">vectorBP</span>'</span>*<span class="mxinfo " id="T3:U149">-<span class="var type1" id="S26T3U194">vectorAB</span></span></span> &gt; <span class="mxinfo " id="T2:U151">0</span></span> <span class="comment">% arrived determination</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">            <span class="mxinfo " id="T3:U152"><span class="var type1" id="S29T3U198">vectorAP</span> = <span class="mxinfo " id="T3:U154"><span class="var type1" id="S13T3U200">uavLocation</span> - <span class="mxinfo " id="T3:U156"><span class="var type1" id="S10T1U202">waypoint_cartesianNE</span>(<span class="mxinfo " id="T4:U158">:</span>,<span class="var type1" id="S17T2U204">i</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">            <span class="mxinfo " id="T2:U160"><span class="var type1" id="S30T2U207">AP_distance</span> = <span class="mxinfo " id="T2:U162">norm(<span class="var type1" id="S29T3U210">vectorAP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T9:U164"><span class="var type1" id="S30T2U215">AP_distance</span> == <span class="mxinfo " id="T2:U166">0</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">                <span class="mxinfo " id="T3:U167"><span class="var type1" id="S31T3U219">vectorAP_unit</span> = <span class="mxinfo " id="T3:U169"><span class="mxinfo " id="T8:U170">[<span class="mxinfo " id="T2:U171">0</span> <span class="mxinfo " id="T2:U172">0</span>]</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">                <span class="mxinfo " id="T3:U173"><span class="var type1" id="S31T3U228">vectorAP_unit</span> = <span class="mxinfo " id="T3:U175"><span class="var type1" id="S29T3U230">vectorAP</span>./<span class="var type1" id="S30T2U231">AP_distance</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">            </span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">            <span class="mxinfo " id="T3:U178"><span class="var type1" id="S24T3U234">vectorBP</span> = <span class="mxinfo " id="T3:U180"><span class="var type1" id="S13T3U236">uavLocation</span> - <span class="mxinfo " id="T3:U182"><span class="var type1" id="S10T1U238">waypoint_cartesianNE</span>(<span class="mxinfo " id="T4:U184">:</span>,<span class="mxinfo " id="T2:U185"><span class="var type1" id="S17T2U241">i</span>+<span class="mxinfo " id="T2:U187">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">            <span class="mxinfo " id="T2:U188"><span class="var type1" id="S25T2U245">BP_distance</span> = <span class="mxinfo " id="T2:U190">norm(<span class="var type1" id="S24T3U248">vectorBP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">            <span class="mxinfo " id="T3:U192"><span class="var type1" id="S32T3U251">vectorBP_unit</span> = <span class="mxinfo " id="T3:U194"><span class="var type1" id="S24T3U253">vectorBP</span>/<span class="var type1" id="S25T2U254">BP_distance</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">            <span class="mxinfo " id="T3:U197"><span class="var type1" id="S33T3U257">vectorV</span> = <span class="mxinfo " id="T3:U199">[<span class="mxinfo " id="T2:U200">sin(<span class="var type1" id="S6T2U262">Yaw</span>)</span>;<span class="mxinfo " id="T2:U202">cos(<span class="var type1" id="S6T2U266">Yaw</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">            <span class="mxinfo " id="T3:U204"><span class="var type1" id="S35T3U269">vectorV_unit</span> = <span class="mxinfo " id="T3:U206"><span class="var type1" id="S33T3U271">vectorV</span>/<span class="mxinfo " id="T2:U208">norm(<span class="var type1" id="S33T3U274">vectorV</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">            <span class="mxinfo " id="T2:U210"><span class="var type1" id="S36T2U277">alongTrackDist</span> = <span class="mxinfo " id="T2:U212"><span class="mxinfo " id="T8:U213"><span class="var type1" id="S29T3U280">vectorAP</span>'</span>*<span class="var type1" id="S28T3U281">vectorAB_unit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">            <span class="mxinfo " id="T2:U216"><span class="var type1" id="S37T2U284">angle_AB_BP</span> = <span class="mxinfo " id="T2:U218">acos(<span class="mxinfo " id="T2:U219"><span class="mxinfo " id="T8:U220"><span class="var type1" id="S28T3U289">vectorAB_unit</span>'</span>*<span class="var type1" id="S32T3U290">vectorBP_unit</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">            <span class="mxinfo " id="T2:U223"><span class="var type1" id="S39T2U293">angle_V_AB</span> = <span class="mxinfo " id="T2:U225">acos(<span class="mxinfo " id="T2:U226"><span class="mxinfo " id="T8:U227"><span class="var type1" id="S35T3U298">vectorV_unit</span>'</span>*<span class="var type1" id="S28T3U299">vectorAB_unit</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T9:U230"><span class="var type1" id="S30T2U305">AP_distance</span> &gt; <span class="var type1" id="S4T2U306">L1_distance</span></span> &amp;&amp; <span class="mxinfo " id="T9:U233">(<span class="mxinfo " id="T2:U234"><span class="var type1" id="S36T2U310">alongTrackDist</span> / <span class="var type1" id="S30T2U311">AP_distance</span></span>) &lt; <span class="mxinfo " id="T2:U237">-<span class="mxinfo " id="T2:U238">0.7071</span></span></span>)<span class="comment">% if <span class="keyword">...</span><span class="comment"> go to waypoint A</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">                <span class="mxinfo " id="T2:U239"><span class="var type1" id="S40T2U316">xtrack_vel</span> = <span class="mxinfo " id="T2:U241"><span class="mxinfo " id="T2:U242"><span class="mxinfo " id="T2:U243"><span class="var type1" id="S35T3U320">vectorV_unit</span>(<span class="mxinfo " id="T6:U245">1</span>)</span>* <span class="mxinfo " id="T2:U246">-<span class="mxinfo " id="T2:U247"><span class="var type1" id="S31T3U324">vectorAP_unit</span>(<span class="mxinfo " id="T2:U249">2</span>)</span></span></span> - <span class="mxinfo " id="T2:U250"><span class="mxinfo " id="T2:U251"><span class="var type1" id="S35T3U328">vectorV_unit</span>(<span class="mxinfo " id="T2:U253">2</span>)</span>* <span class="mxinfo " id="T2:U254">-<span class="mxinfo " id="T2:U255"><span class="var type1" id="S31T3U332">vectorAP_unit</span>(<span class="mxinfo " id="T2:U257">1</span>)</span></span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">                <span class="mxinfo " id="T2:U258"><span class="var type1" id="S41T2U336">ltrack_vel</span> = <span class="mxinfo " id="T2:U260"><span class="mxinfo " id="T8:U261">-<span class="mxinfo " id="T8:U262"><span class="var type1" id="S31T3U340">vectorAP_unit</span>'</span></span>*<span class="var type1" id="S35T3U341">vectorV_unit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">                <span class="mxinfo " id="T2:U265"><span class="var type1" id="S42T2U344">eta</span> = <span class="mxinfo " id="T2:U267">atan2(<span class="var type1" id="S40T2U347">xtrack_vel</span>,<span class="var type1" id="S41T2U348">ltrack_vel</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">            <span class="keyword">elseif</span> (<span class="mxinfo " id="T9:U270"><span class="mxinfo " id="T2:U271">abs(<span class="var type1" id="S37T2U355">angle_AB_BP</span>)</span> &lt; <span class="mxinfo " id="T2:U273">deg2rad(<span class="mxinfo " id="T2:U274">100</span>)</span></span> || <span class="mxinfo " id="T9:U275"><span class="mxinfo " id="T2:U276">abs(<span class="var type1" id="S39T2U362">angle_V_AB</span>)</span> &gt;= <span class="mxinfo " id="T2:U278">deg2rad(<span class="mxinfo " id="T2:U279">90</span>)</span></span>)<span class="comment">% if miss waypoint B, go to waypoint B</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">                <span class="mxinfo " id="T2:U280"><span class="var type1" id="S40T2U368">xtrack_vel</span> = <span class="mxinfo " id="T2:U282"><span class="mxinfo " id="T2:U283"><span class="mxinfo " id="T2:U284"><span class="var type1" id="S35T3U372">vectorV_unit</span>(<span class="mxinfo " id="T6:U286">1</span>)</span>* <span class="mxinfo " id="T2:U287">-<span class="mxinfo " id="T2:U288"><span class="var type1" id="S32T3U376">vectorBP_unit</span>(<span class="mxinfo " id="T2:U290">2</span>)</span></span></span> - <span class="mxinfo " id="T2:U291"><span class="mxinfo " id="T2:U292"><span class="var type1" id="S35T3U380">vectorV_unit</span>(<span class="mxinfo " id="T2:U294">2</span>)</span>* <span class="mxinfo " id="T2:U295">-<span class="mxinfo " id="T2:U296"><span class="var type1" id="S32T3U384">vectorBP_unit</span>(<span class="mxinfo " id="T2:U298">1</span>)</span></span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">                <span class="mxinfo " id="T2:U299"><span class="var type1" id="S41T2U388">ltrack_vel</span> = <span class="mxinfo " id="T2:U301"><span class="mxinfo " id="T8:U302">-<span class="mxinfo " id="T8:U303"><span class="var type1" id="S32T3U392">vectorBP_unit</span>'</span></span>*<span class="var type1" id="S35T3U393">vectorV_unit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">                <span class="mxinfo " id="T2:U306"><span class="var type1" id="S42T2U396">eta</span> = <span class="mxinfo " id="T2:U308">atan2(<span class="var type1" id="S40T2U399">xtrack_vel</span>,<span class="var type1" id="S41T2U400">ltrack_vel</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">            <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">                <span class="mxinfo " id="T2:U311"><span class="var type1" id="S40T2U404">xtrack_vel</span> = <span class="mxinfo " id="T2:U313"><span class="mxinfo " id="T2:U314"><span class="mxinfo " id="T2:U315"><span class="var type1" id="S35T3U408">vectorV_unit</span>(<span class="mxinfo " id="T6:U317">1</span>)</span>* <span class="mxinfo " id="T2:U318"><span class="var type1" id="S28T3U411">vectorAB_unit</span>(<span class="mxinfo " id="T2:U320">2</span>)</span></span> - <span class="mxinfo " id="T2:U321"><span class="mxinfo " id="T2:U322"><span class="var type1" id="S35T3U415">vectorV_unit</span>(<span class="mxinfo " id="T2:U324">2</span>)</span>* <span class="mxinfo " id="T2:U325"><span class="var type1" id="S28T3U418">vectorAB_unit</span>(<span class="mxinfo " id="T2:U327">1</span>)</span></span></span></span>;<span class="comment">% fly along the line AB</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">                <span class="mxinfo " id="T2:U328"><span class="var type1" id="S41T2U422">ltrack_vel</span> = <span class="mxinfo " id="T2:U330"><span class="mxinfo " id="T8:U331"><span class="var type1" id="S28T3U425">vectorAB_unit</span>'</span>*<span class="var type1" id="S35T3U426">vectorV_unit</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">                <span class="mxinfo " id="T2:U334"><span class="var type1" id="S46T2U429">eta2</span> = <span class="mxinfo " id="T2:U336">atan2(<span class="var type1" id="S40T2U432">xtrack_vel</span>,<span class="var type1" id="S41T2U433">ltrack_vel</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">                <span class="mxinfo " id="T2:U339"><span class="var type1" id="S47T2U436">xtrackErr</span> = <span class="mxinfo " id="T2:U341"><span class="mxinfo " id="T2:U342"><span class="mxinfo " id="T2:U343"><span class="var type1" id="S29T3U440">vectorAP</span>(<span class="mxinfo " id="T6:U345">1</span>)</span>* <span class="mxinfo " id="T2:U346"><span class="var type1" id="S28T3U443">vectorAB_unit</span>(<span class="mxinfo " id="T2:U348">2</span>)</span></span> - <span class="mxinfo " id="T2:U349"><span class="mxinfo " id="T2:U350"><span class="var type1" id="S29T3U447">vectorAP</span>(<span class="mxinfo " id="T2:U352">2</span>)</span>* <span class="mxinfo " id="T2:U353"><span class="var type1" id="S28T3U450">vectorAB_unit</span>(<span class="mxinfo " id="T2:U355">1</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">                <span class="mxinfo " id="T2:U356"><span class="var type1" id="S48T2U454">sine_eta1</span> = <span class="mxinfo " id="T2:U358">sin(<span class="mxinfo " id="T2:U359"><span class="var type1" id="S47T2U458">xtrackErr</span>/<span class="var type1" id="S4T2U459">L1_distance</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo " id="T9:U362"><span class="var type1" id="S48T2U463">sine_eta1</span> &gt; <span class="mxinfo " id="T2:U364"><span class="mxinfo " id="T2:U365">pi</span>/<span class="mxinfo " id="T2:U366">4</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">                    <span class="mxinfo " id="T2:U367"><span class="var type1" id="S48T2U470">sine_eta1</span> = <span class="mxinfo " id="T2:U369"><span class="mxinfo " id="T2:U370">pi</span>/<span class="mxinfo " id="T2:U371">4</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">                <span class="keyword">elseif</span> <span class="mxinfo " id="T9:U372"><span class="var type1" id="S48T2U477">sine_eta1</span> &lt; <span class="mxinfo " id="T2:U374"><span class="mxinfo " id="T2:U375">-pi</span>/<span class="mxinfo " id="T2:U376">4</span></span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">                    <span class="mxinfo " id="T2:U377"><span class="var type1" id="S48T2U485">sine_eta1</span> = <span class="mxinfo " id="T2:U379"><span class="mxinfo " id="T2:U380">-pi</span>/<span class="mxinfo " id="T2:U381">4</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">                <span class="mxinfo " id="T2:U382"><span class="var type1" id="S50T2U493">eta1</span> = <span class="mxinfo " id="T2:U384">asin(<span class="var type1" id="S48T2U496">sine_eta1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">                <span class="mxinfo " id="T2:U386"><span class="var type1" id="S42T2U499">eta</span> = <span class="mxinfo " id="T2:U388"><span class="var type1" id="S50T2U501">eta1</span> + <span class="var type1" id="S46T2U502">eta2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">            <span class="comment">% The angle of eta large than 0 means require a negative roll (going to left)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">            <span class="mxinfo " id="T10:U391"><span class="var type1" id="S52T10U505">TransformMatrix</span> =   <span class="mxinfo " id="T10:U393">[<span class="mxinfo " id="T8:U394"><span class="mxinfo " id="T2:U395">cos(<span class="var type1" id="S6T2U510">Yaw</span>)</span> <span class="mxinfo " id="T2:U397">sin(<span class="var type1" id="S6T2U513">Yaw</span>)</span></span>;<span class="comment">% transform from body to NED</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">                                <span class="mxinfo " id="T8:U399"><span class="mxinfo " id="T2:U400">-<span class="mxinfo " id="T2:U401">sin(<span class="var type1" id="S6T2U518">Yaw</span>)</span></span> <span class="mxinfo " id="T2:U403">cos(<span class="var type1" id="S6T2U521">Yaw</span>)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">            <span class="comment">% change sign of the eta for calculate correct lateral acceleration</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">            <span class="mxinfo " id="T2:U405"><span class="var type1" id="S42T2U524">eta</span> = <span class="mxinfo " id="T2:U407">-<span class="var type1" id="S42T2U526">eta</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">            <span class="mxinfo " id="T2:U409"><span class="var type1" id="S53T2U529">LA</span> = <span class="mxinfo " id="T2:U411"><span class="mxinfo " id="T2:U412"><span class="mxinfo " id="T2:U413">2</span>*<span class="mxinfo " id="T2:U414">sin(<span class="var type1" id="S42T2U535">eta</span>)</span></span>/<span class="var type1" id="S4T2U536">L1_distance</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">            <span class="comment">% airplane lateral dynamics</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">            <span class="mxinfo " id="T2:U417"><span class="var type1" id="S54T2U539">MAX_LateralAcceleration</span> = <span class="mxinfo " id="T2:U419">0.01</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T9:U420"><span class="var type1" id="S53T2U544">LA</span> &gt; <span class="var type1" id="S54T2U545">MAX_LateralAcceleration</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">                <span class="mxinfo " id="T2:U423"><span class="var type1" id="S53T2U548">LA</span> = <span class="var type1" id="S54T2U549">MAX_LateralAcceleration</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">            <span class="mxinfo " id="T2:U426"><span class="var type1" id="S55T2U552">R</span> = <span class="mxinfo " id="T2:U428"><span class="mxinfo " id="T2:U429">1</span>/<span class="var type1" id="S53T2U555">LA</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">            <span class="mxinfo " id="T2:U431"><span class="var type1" id="S56T2U558">AL</span> = <span class="mxinfo " id="T2:U433">1</span></span>; <span class="comment">% arc length unit:m/s (this value determine the iteration precision)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">            <span class="mxinfo " id="T2:U434"><span class="var type1" id="S57T2U562">theta</span>  = <span class="mxinfo " id="T2:U436"><span class="var type1" id="S56T2U564">AL</span>/<span class="var type1" id="S55T2U565">R</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">            <span class="mxinfo " id="T3:U439"><span class="var type1" id="S58T3U568">vectorPP2_body</span> = <span class="mxinfo " id="T3:U441"><span class="mxinfo " id="T8:U442">[<span class="mxinfo " id="T2:U443"><span class="var type1" id="S55T2U573">R</span>-<span class="mxinfo " id="T2:U445"><span class="var type1" id="S55T2U575">R</span>*<span class="mxinfo " id="T2:U447">cos(<span class="var type1" id="S57T2U578">theta</span>)</span></span></span> <span class="mxinfo " id="T2:U449"><span class="var type1" id="S55T2U580">R</span>*<span class="mxinfo " id="T2:U451">sin(<span class="var type1" id="S57T2U583">theta</span>)</span></span>]</span>'</span></span>;<span class="comment">% a vector in body coordination, represent uav location in this time stamp to the next time stamp</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">            <span class="mxinfo " id="T3:U453"><span class="var type1" id="S59T3U586">vectorPP2_NED</span> = <span class="mxinfo " id="T3:U455"><span class="var type1" id="S52T10U588">TransformMatrix</span>*<span class="var type1" id="S58T3U589">vectorPP2_body</span></span></span>;<span class="comment">% tramsform vector to NED frame</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">            <span class="mxinfo " id="T3:U458"><span class="var type1" id="S13T3U592">uavLocation</span> = <span class="mxinfo " id="T3:U460"><span class="var type1" id="S13T3U594">uavLocation</span> + <span class="var type1" id="S59T3U595">vectorPP2_NED</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">            <span class="mxinfo " id="T2:U463"><span class="var type1" id="S6T2U598">Yaw</span> = <span class="mxinfo " id="T2:U465"><span class="var type1" id="S6T2U600">Yaw</span> + <span class="var type1" id="S57T2U601">theta</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">            <span class="mxinfo " id="T2:U468"><span class="var type1" id="S23T2U604">numOfPoint</span> = <span class="mxinfo " id="T2:U470"><span class="var type1" id="S23T2U606">numOfPoint</span> +<span class="mxinfo " id="T2:U472">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">            <span class="keyword">if</span> (<span class="mxinfo " id="T9:U473"><span class="var type1" id="S23T2U612">numOfPoint</span> &gt; <span class="var type1" id="S19T2U613">predictNumOfPoint</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">                error(<span class="string">'out of memory'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">            <span class="mxinfo " id="T3:U476"><span class="mxinfo " id="T3:U477"><span class="var type1" id="S21T1U621">point_cartesianNE</span>(<span class="mxinfo " id="T4:U479">:</span>,<span class="var type1" id="S23T2U623">numOfPoint</span>)</span> = <span class="var type1" id="S13T3U624">uavLocation</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">    <span class="mxinfo " id="T1:U482"><span class="var type1" id="S2T1U627">point_latlon</span> = <span class="mxinfo " id="T1:U484">zeros(<span class="mxinfo " id="T2:U485">2</span>,<span class="var type1" id="S23T2U631">numOfPoint</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">    <span class="comment">% cartesian to polar</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">    <span class="mxinfo " id="T5:U487"><span class="mxinfo " id="T5:U488"><span class="var type1" id="S2T1U635">point_latlon</span>(<span class="mxinfo " id="T6:U490">1</span>,<span class="mxinfo " id="T7:U491">:</span>)</span> = <span class="mxinfo " id="T5:U492"><span class="mxinfo " id="T2:U493"><span class="var type1" id="S5T3U640">uavHome_latlon</span>(<span class="mxinfo " id="T2:U495">1</span>)</span> + <span class="mxinfo " id="T5:U496"><span class="mxinfo " id="T5:U497"><span class="var type1" id="S21T1U644">point_cartesianNE</span>(<span class="mxinfo " id="T6:U499">1</span>,<span class="mxinfo " id="T5:U500"><span class="mxinfo " id="T2:U501">1</span>:<span class="var type1" id="S23T2U648">numOfPoint</span></span>)</span>./<span class="var type1" id="S9T2U649">radiousOfEarth</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo " id="T5:U504"><span class="mxinfo " id="T5:U505"><span class="var type1" id="S2T1U653">point_latlon</span>(<span class="mxinfo " id="T6:U507">2</span>,<span class="mxinfo " id="T7:U508">:</span>)</span> = <span class="mxinfo " id="T5:U509"><span class="mxinfo " id="T2:U510"><span class="var type1" id="S5T3U658">uavHome_latlon</span>(<span class="mxinfo " id="T2:U512">2</span>)</span> + <span class="mxinfo " id="T5:U513"><span class="mxinfo " id="T5:U514"><span class="mxinfo " id="T5:U515"><span class="var type1" id="S21T1U663">point_cartesianNE</span>(<span class="mxinfo " id="T6:U517">2</span>,<span class="mxinfo " id="T5:U518"><span class="mxinfo " id="T2:U519">1</span>:<span class="var type1" id="S23T2U667">numOfPoint</span></span>)</span>./<span class="var type1" id="S9T2U668">radiousOfEarth</span></span>./<span class="mxinfo " id="T2:U522">cos(<span class="mxinfo " id="T2:U523"><span class="var type1" id="S5T3U672">uavHome_latlon</span>(<span class="mxinfo " id="T6:U525">1</span>)</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line"><span class="comment">%% for simulation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line"><span class="comment">% plot(point_cartesianNE(2,1:numOfPoint),point_cartesianNE(1,1:numOfPoint)); axis equal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line"><span class="comment">% hold on;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line"><span class="comment">% plot(waypoint_cartesianNE(2,:),waypoint_cartesianNE(1,:)); % plot waypoint line</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"><span class="comment">% hold on;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line"><span class="comment">% plot(waypoint_cartesianNE(2,:),waypoint_cartesianNE(1,:),'*'); % plot waypoint</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line"><span class="comment">% for i = 1:numOfWaypoint</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line"><span class="comment">%     text(waypoint_cartesianNE(2,i),waypoint_cartesianNE(1,i),num2str(i-1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line"><span class="comment">% end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line"><span class="comment">% text(uavHome_cartesian(2),uavHome_cartesian(1),'uav home');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line"><span class="comment">% title('uav trajectory simulation');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line"><span class="comment">% xlabel('east meter');</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line"><span class="comment">% ylabel('north meter');</span></span></span>
</pre>
</body>
</html>
